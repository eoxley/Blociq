<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>BlocIQ Functions</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <script>
        // Global error handling
        window.addEventListener('error', (event) => {
            console.error('[BlocIQ Functions] Global error:', event.error);
        });

        // Load the main functions script
        (function() {
            const script = document.createElement('script');
            script.src = 'https://www.blociq.co.uk/outlook-addin/functions.js';
            script.onload = function() {
                console.log('[BlocIQ Functions] Main functions script loaded');
            };
            script.onerror = function() {
                console.error('[BlocIQ Functions] Failed to load main functions script');
            };
            document.head.appendChild(script);
        })();

        Office.onReady(() => {
            console.log('[BlocIQ Functions] Office.js ready');
        });
    </script>
</body>
</html>