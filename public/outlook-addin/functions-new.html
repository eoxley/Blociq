<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <script>
        Office.onReady(function() {
            console.log('Functions file loaded');
        });
        
        function generateReply(event) {
            Office.context.mailbox.item.body.getAsync(
                Office.CoercionType.Text,
                function(result) {
                    if (result.status === Office.AsyncResultStatus.Succeeded) {
                        const emailContent = result.value;
                        
                        // Get subject
                        const subject = Office.context.mailbox.item.subject;
                        
                        // Simple AI reply generation (replace with actual API)
                        const reply = generateAIReply(emailContent, subject);
                        
                        // Open compose window with reply
                        Office.context.mailbox.displayReplyForm({
                            htmlBody: reply
                        });
                    }
                    event.completed();
                }
            );
        }
        
        function generateAIReply(emailContent, subject) {
            // Placeholder AI reply logic
            const responses = [
                "Thank you for your email. I'll review this matter and get back to you shortly.",
                "I appreciate you bringing this to my attention. Let me look into this and respond accordingly.",
                "Thanks for reaching out. I'll investigate this issue and provide an update soon."
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            
            return `
                <p>Dear Tenant/Client,</p>
                <p>${randomResponse}</p>
                <p>Best regards,<br>
                Property Management Team<br>
                BlocIQ</p>
            `;
        }
        
        // Register functions
        if (window.Office && Office.actions) {
            Office.actions.associate("generateReply", generateReply);
        }
    </script>
</body>
</html>